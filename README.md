# [studioetrange/kcc](https://github.com/studioetrange/docker-kcc)

[Kindle Comic Converter](https://github.com/ciromattia/kcc) is a Python app to convert comic/manga files or folders to EPUB, Panel View MOBI or E-Ink optimized CBZ.

This docker image let you choose which version from any git repository, original or forked kcc version. It also embed amazon kindlegen 2.9.

I have created this image to have the ability to support various kind of fork and PR of KCC including [mine](https://github.com/StudioEtrange/kcc)

## Supported Architectures

The architectures supported by this image are:

| Architecture | Tag |
| :----: | --- |
| x86-64 | latest |@


## Usage

Here are some example snippets to help you get started creating a container.

### docker-compose ([recommended](https://docs.linuxserver.io/general/docker-compose))

Compatible with docker-compose v2 schemas.

```yaml
---
version: "2.1"
services:
  calibre:
    image: studioetrange/kcc
    container_name: kcc
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - GUAC_USER=abc #optional
      - GUAC_PASS=900150983cd24fb0d6963f7d28e17f72 #optional
      - UMASK_SET=022 #optional
      - KCC_VERSION=master #optional
      - REPO_GIT=https://github.com/ciromattia/kcc #optional
    volumes:
      - /path/to/data:/config
    ports:
      - 8080:8080
      - 3389:3389
    restart: unless-stopped
```

### docker cli

```
docker run -d \
  --name=kcc \
  -e PUID=1000 \
  -e PGID=1000 \
  -e TZ=Europe/London \
  -e GUAC_USER=abc `#optional` \
  -e GUAC_PASS=900150983cd24fb0d6963f7d28e17f72 `#optional` \
  -e UMASK_SET=022 `#optional` \
  -e KCC_VERSION=master `#optional` \
  -e REPO_GIT=https://github.com/ciromattia/kcc `#optional` \
  -p 8080:8080 \
  -p 3389:3389 \
  -v /path/to/data:/config \
  --restart unless-stopped \
  studioetrange/kcc
```


## Parameters


| Parameter | Function |
| :----: | --- |
| `-p 8080` | Guacamole web Desktop gui. |
| `-p 3389` | RDP port. |
| `-e PUID=1000` | for UserID - see below for explanation |
| `-e PGID=1000` | for GroupID - see below for explanation |
| `-e TZ=Europe/London` | Specify a timezone to use EG Europe/London. |
| `-e GUAC_USER=abc` | Username for the desktop gui. |
| `-e GUAC_PASS=900150983cd24fb0d6963f7d28e17f72` | Password's md5 hash for the calibre desktop gui. |
| `-e UMASK_SET=022` | for umask setting, default if left unset is 022. |
| `-e REPO_GIT=https://github.com/ciromattia/kcc` | git repository from where to install kcc, default is https://github.com/ciromattia/kcc. |
| `-e KCC_VERSION=master` | tag or commit in git repository, default is master. |
| `-v /config` | Where kcc should store some config. |


## Umask for running applications

For all of our images we provide the ability to override the default umask settings for services started within the containers using the optional `-e UMASK=022` setting.
Keep in mind umask is not chmod it subtracts from permissions based on it's value it does not add. Please read up [here](https://en.wikipedia.org/wiki/Umask) before asking for support.

## User / Group Identifiers

When using volumes (`-v` flags) permissions issues can arise between the host OS and the container, we avoid this issue by allowing you to specify the user `PUID` and group `PGID`.

Ensure any volume directories on the host are owned by the same user you specify and any permissions issues will vanish like magic.

In this instance `PUID=1000` and `PGID=1000`, to find yours use `id user` as below:

```
  $ id username
    uid=1000(dockeruser) gid=1000(dockergroup) groups=1000(dockergroup)
```


&nbsp;
## Application Setup

This image sets up the desktop app and makes its interface available via Guacamole server in the browser. The interface is available at `http://your-ip:8080`.

By default, there is no username or password set. Custom usernames and passwords can be set via optional docker environment variables. Keep in mind that the `GUACPASS` variable accepts the `md5 hash` of the desired password (the sample above is the hash for `abc`). The md5 hash can be generated by either of the following commands:

```
echo -n password | openssl md5
```

```
printf '%s' password | md5sum
```

Port 8081 is reserved for Calibre's built-in webserver, which can be enabled within the desktop app settings, and the internal port must be set to `8081` although it will then be available at the host mapped port for external access.

You can access advanced features of the Guacamole remote desktop using `ctrl`+`alt`+`shift` enabling you to use remote copy/paste and different languages.


## Building locally

If you want to make local modifications to these images for development purposes or just to customize the logic:
```
git clone https://github.com/studioetrange/docker-kcc.git
cd docker-kcc
docker build \
  --no-cache \
  --pull \
  -t studioetrange/kcc:latest .
```

